//-------------------------------------------------------------------------------------------------------------
// Name: Leona Eclipse
// Author: Zarthbenn
// Date: 06/2015
//-------------------------------------------------------------------------------------------------------------
"leona_eclipse"
{
	// General
	//-------------------------------------------------------------------------------------------------------------
	"BaseClass"						"ability_datadriven"
	"AbilityBehavior"				"DOTA_ABILITY_BEHAVIOR_NO_TARGET | DOTA_ABILITY_BEHAVIOR_IMMEDIATE"
	"AbilityTextureName"			"leona_eclipse"
	"MaxLevel"						"5"

	"AbilityCooldown"				"14"
	"AbilityManaCost"				"60"

	// Precache
	//-------------------------------------------------------------------------------------------------------------
	"precache"
	{
		"particle"					"particles/units/heroes/hero_medusa/medusa_mana_shield.vpcf"
		"soundfile"   				"soundevents/game_sounds_heroes/game_sounds_slardar.vsndevts"
	  	"particle"					"particles/units/heroes/hero_slardar/slardar_crush.vpcf"
	  	"particle"					"particles/units/heroes/hero_slardar/slardar_crush_entity.vpcf"
	  	"particle" 					"particles/units/heroes/hero_legion_commander/legion_commander_duel_buff.vpcf"
	}
	
	// Casting
	//-------------------------------------------------------------------------------------------------------------
	"AbilityCastPoint"				"0.0"
	"AbilityCastRange"				"200"

	// Damage.
	//-------------------------------------------------------------------------------------------------------------
	"AbilityDamage"					"60 110 160 210 260"	//-- +40% Ability Power
	"AbilityUnitDamageType"			"DAMAGE_TYPE_MAGICAL"
	
	// Special
	//-------------------------------------------------------------------------------------------------------------
	"AbilitySpecial"
	{
		"01"
		{	
			"var_type"			"FIELD_FLOAT"
			"bonus_armor"		"20 30 40 50 60" //-- +20% bonus armor
		}
		"02"
		{
			"var_type"			"FIELD_INTEGER"
			"bonus_mr" 			"20 30 40 50 60" //-- +20% bonus magic resistance
		}
		"03"
		{
			"var_type"					"FIELD_INTEGER"
			"eclipse_radius"			"200"
		}
	}
	
	"OnSpellStart"
	{
		"ApplyModifier"
		{
			"Target"				"CASTER"
			"ModifierName"			"modifier_eclipse"
		}
	}

	"Modifiers"
	{
		"modifier_eclipse"
		{
			"IsBuff"	"1"
			"duration"	"3"

			"EffectName"		"particles/units/heroes/hero_medusa/medusa_mana_shield.vpcf"
			"EffectAttachType"	"follow_origin"	

			"Properties"
	    	{
	    		"MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS" "%bonus_armor"
	    		"MODIFIER_PROPERTY_MAGICAL_RESISTANCE_BONUS" "%bonus_mr"
	    	}
			
			"OnDestroy"
			{
				"FireEffect"
				{
					"EffectName"	"particles/units/heroes/hero_slardar/slardar_crush.vpcf"
					"EffectAttachType"	"attach_origin"
					"Target"	"CASTER"

				}
				"FireEffect"
				{
					"EffectName"	"particles/units/heroes/hero_slardar/slardar_crush_entity.vpcf"
					"EffectAttachType" "attach_origin"
					"Target"	"CASTER" 
				}
				"FireSound"
				{
					"EffectName" "Hero_Slardar.Slithereen_Crush"
					"Target"	"CASTER"
				}
				"ActOnTargets"
				{
					"Target"
					{
						"Center" "CASTER"
						"Radius" "%eclipse_radius"
						"Teams"	"DOTA_UNIT_TARGET_TEAM_ENEMY"
						"Types" "DOTA_UNIT_TARGET_BASIC | DOTA_UNIT_TARGET_HERO"
						"Flags" "DOTA_UNIT_TARGET_FLAG_MAGIC_IMMUNE_ENEMIES"
					}
					
					"Action"
					{
						"ApplyModifier"
						{
							"Target"		"CASTER"
							"ModifierName"	"modifier_eclipse_sustained"
						}
						"Damage"
						{
							"Target"		"TARGET"
							"Type"			"DAMAGE_TYPE_MAGICAL"
							"Damage"		"%AbilityDamage"
						}
						"RunScript"
						{
							"ScriptFile"		"heroes/leona/sunlight.lua"
							"Function"			"ApplyModifier"
						}
					}
				}
			}
		}
		"modifier_eclipse_sustained"
		{
			"IsHidden"	"1"
			"duration"	"3"

			"Properties"
	    	{
	    		"MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS" "%bonus_armor"
	    		"MODIFIER_PROPERTY_MAGICAL_RESISTANCE_BONUS" "%bonus_mr"
	    	}
		}
	}
}